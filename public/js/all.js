var data=localStorage.getItem("todoList")?JSON.parse(localStorage.getItem("todoList")):{todo:[],completed:[]};function renderTodoListToHTML(){if(0==data.completed.length&&0==data.todo.length);else{for(var t=0;t<data.todo.length;t++){addItemTodo(data.todo[t])}for(var e=0;e<data.completed.length;e++){addItemTodo(data.completed[e],!0)}}onTouchStart()}function dataObjectUpdated(){localStorage.setItem("todoList",JSON.stringify(data))}function addItemTodo(t,e){var o=e?document.getElementById("completed"):document.getElementById("todo"),a=document.createElement("div");a.classList.add("container"),a.classList.add("mirror"),a.setAttribute("id","container"),a.style.opacity=0;var d='<div class="row">                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">                            <div class="content">                                <ul class="items">                                \t<li class="item">                                        <i class="fa fa-bars fa-1x handle" aria-hidden="true"></i>                                    </li>                                    <li class="item">                                        <p class="text" id="text">'+t+'</p>                                    </li>                                    <li class="item delete">                                        <a id="delete" class="deleteButton"><i class="fa fa-trash-o fa-2x" aria-hidden="true"></i></a>                                    </li>                                    <li class="item check">                                       <button id="check" class="checkButton"><i class="fa fa-check-circle-o fa-2x" aria-hidden="true"></i></button>                                    </li>                                </ul>                            </div>                        </div>\t                </div>';a.innerHTML=d,o.insertBefore(a,o.childNodes[0]),fadeIn(a);for(var n=document.getElementsByClassName("deleteButton"),i=0;i<n.length;i++)n[i].addEventListener("touchstart",removeItem);var r=document.getElementsByClassName("checkButton");for(i=0;i<r.length;i++)r[i].addEventListener("touchstart",completeItem)}function completeItem(){var t=this.parentNode.parentNode.querySelector("#text").innerText,e=this.closest("#container"),o=e.parentNode.id;this.setAttribute("disabled",!0),"todo"===o?(data.todo.splice(data.todo.indexOf(t),1),data.completed.push(t)):(data.completed.splice(data.completed.indexOf(t),1),data.todo.push(t)),fadeOut(this,e,"todo"==o?document.getElementById("completed"):document.getElementById("todo"),!0),dataObjectUpdated(),vibrate()}function removeItem(){var t=this.closest("#container"),e=t.parentNode.id,o=this.parentNode.parentNode.querySelector("#text").innerText;"todo"===e?data.todo.splice(data.todo.indexOf(o),1):data.completed.splice(data.completed.indexOf(o),1),fadeOut(!1,t,!1,!1),dataObjectUpdated(),vibrate()}function fadeOut(t,e,o,a){var d=setInterval(function(){(n-=.1)<=0&&(clearInterval(d),!0===a?(o.insertBefore(e,o.childNodes[0]),fadeIn(e),t.removeAttribute("disabled")):e.remove()),e.style.opacity=n},40),n=1}function fadeIn(t){var e=setInterval(function(){(o+=.1)>=1&&(clearInterval(e),o=1),t.style.opacity=o},40),o=.1}function intro(){var t=document.getElementById("intro"),e=document.getElementById("todo-app");setTimeout(function(){t.style.display="none",e.style.display="block"},2e3)}function onTouchStart(){console.log("onTouchStart");for(var t,e,o,a=document.querySelectorAll(".mirror"),d=!1,n=800,i=0;i<a.length;i++)a[i].querySelector(".handle").addEventListener("touchstart",r,!1),a[i].querySelector(".handle").addEventListener("touchend",l,!1);function r(a){a.preventDefault(),(o=this).closest("#container").removeAttribute("style"),e||(t=setTimeout(c,n),e=!0)}function l(){t&&(clearTimeout(t),e=!1),observeDrop(this)}function c(){var t="todo"==o.closest("#container").parentNode.getAttribute("id")?o.closest("#container").offsetTop-window.scrollY+130:o.closest("#container").offsetTop+document.querySelector("#todo").offsetHeight-window.scrollY+170;d=!0,s.lift(o),u.lift(o);var e=document.querySelector(".gu-mirror");e.style.top=t+"px",e.style.left="20px",vibrate()}var s=dragula([document.getElementById("todo")],{moves:function(t,e,o){if(d)return d=!1,o.classList.contains("handle")}}),u=dragula([document.getElementById("completed")],{moves:function(t,e,o){if(d)return d=!1,o.classList.contains("handle")}})}function observeDrop(t){var e=t.closest("#container").parentNode,o=e.querySelectorAll(".container");if("todo"==e.getAttribute("id")){console.log("if on todo",e.querySelectorAll(".container")),data.todo=[];for(var a=0;a<o.length;a++)data.todo.unshift(o[a].querySelector(".text").innerText)}else{data.completed=[];for(a=0;a<o.length;a++)data.completed.unshift(o[a].querySelector(".text").innerText)}dataObjectUpdated()}function vibrate(){console.log(navigator.vibrate),navigator.vibrate(100)}renderTodoListToHTML(),document.getElementById("add").addEventListener("touchstart",function(){var t=document.getElementById("item").value;t&&(addItemTodo(t),document.getElementById("item").value="",data.todo.push(t),dataObjectUpdated(),onTouchStart(),vibrate())}),document.getElementById("item").addEventListener("keydown",function(t){var e=this.value;(13===t.keyCode&&e||13===t.keyCode&&e)&&(addItemTodo(e),document.getElementById("item").value="",data.todo.push(e),dataObjectUpdated(),onTouchStart(),vibrate())}),intro(),document.addEventListener("deviceready",vibrate,!1);